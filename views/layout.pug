doctype html
html(lang="en")
    head
        meta(charset="utf-8")
        meta(name="viewport" content="width=device-width, initial-scale=1")
        title= tenant.name + " – Cheap Bus Tickets"
        meta(name="description" content=tenant.name + " lets you buy tickets online in 4 steps for a comfortable journey.")
        link(rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css")
        link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css")
        link(rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css")
        link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css")
        link(rel="stylesheet" href="/css/style.css")
        block css
        script(type="application/ld+json").
            {
                "@context": "https://schema.org",
                "@type": "Organization",
                "name": "!{tenant.name}",
                "url": "!{tenant.apiBase}",
                "logo": "!{tenant.logo}",
                "telephone": "!{tenant.phone}"
            }
    body
        // 1) TOP BAR
        .top-bar.text-white.small
            .container.d-flex.justify-content-end.align-items-center.py-2.gap-2
                span Customer Support
                if tenant.phone
                    a.text-white.text-decoration-none(href="tel:" + tenant.phone.replace(/\s/g, ""))
                        i.bi.bi-telephone.me-1
                        = tenant.phone

        // 2) NAVBAR
        nav.navbar.navbar-expand-lg.navbar-light.bg-white.shadow-sm.sticky-top
            .container
                a.navbar-brand(href="/")
                    img(src=`/images/logo.png` height="75" alt=tenant.name loading="lazy")
                button.navbar-toggler(type="button" data-bs-toggle="collapse" data-bs-target="#mainNav"
                    aria-controls="mainNav" aria-expanded="false" aria-label="Menu")
                    span.navbar-toggler-icon
                #mainNav.collapse.navbar-collapse
                    ul.navbar-nav.mx-auto.mb-2.mb-lg-0
                        li.nav-item: a.nav-link.fs-5.ms-1(href="#") Corporate
                        li.nav-item: a.nav-link.fs-5.ms-1(href="#") Our Branches
                        li.nav-item: a.nav-link.fs-5.ms-1(href="#") Online Services
                        li.nav-item: a.nav-link.fs-5.ms-1(href="#") Contact
                    .d-flex.gap-2.align-items-center#auth-buttons
                        if user
                            // --- IF LOGGED IN ---
                            .dropdown
                                button.btn.btn-outline.dropdown-toggle.d-flex.align-items-center.gap-2(type="button" data-bs-toggle="dropdown")
                                    .bg-primary.text-white.rounded-circle.d-flex.align-items-center.justify-content-center(style="width:32px; height:32px;")
                                        i.bi.bi-person-fill
                                    .text-start.lh-1
                                        .small.mb-1 Welcome
                                        .fw-bold= user.name + " " + user.surname
                                ul.dropdown-menu.dropdown-menu-end.shadow.border-0.mt-2
                                    li
                                        a.dropdown-item(href="/profile")
                                            i.bi.bi-person-gear.me-2
                                            | My Account
                                    li
                                        a.dropdown-item(href="/my-tickets")
                                            i.bi.bi-ticket-perforated.me-2
                                            | My Tickets
                                    li
                                        hr.dropdown-divider
                                    li
                                        a.dropdown-item.text-danger(href="/logout")
                                            i.bi.bi-box-arrow-right.me-2
                                            | Log Out
                        else
                            button.btn.btn-sm.btn-outline-primary(type="button" data-bs-toggle="modal" data-bs-target="#registerModal") Sign Up
                            button.btn.btn-sm.btn-primary(type="button" data-bs-toggle="modal" data-bs-target="#loginModal") Log In

        main
            block content

        // 10) FOOTER
        footer.bg-dark.text-white.py-4
            .container
                .row.align-items-center
                    .col-md-6.mb-3.mb-md-0
                        img.mb-2(src=`/images/logo.png` height="35" alt=tenant.name loading="lazy")
                        .small © 2025 #{tenant.name}. All rights reserved.
                    .col-md-6.text-md-end
                        .d-flex.gap-3.justify-content-md-end
                            if tenant.phone
                                a.btn.btn-outline-light.btn-sm(href="https://wa.me/" + tenant.phone.replace(/\s/g, ""))
                                    i.bi.bi-whatsapp.me-1
                                    | WhatsApp
                                a.btn.btn-outline-light.btn-sm(href="tel:" + tenant.phone.replace(/\s/g, ""))
                                    i.bi.bi-telephone.me-1
                                    | Call
                .mt-3.small.text-center
                    a.text-white-50.me-3(href="#") Privacy
                    a.text-white-50.me-3(href="#") Terms of Use
                    a.text-white-50(href="#") Cookie Policy

        // --- AUTH MODALS ---

        // 1) LOGIN MODAL
        .modal.fade#loginModal(tabindex="-1" aria-hidden="true")
            .modal-dialog.modal-dialog-centered
                .modal-content.border-0.shadow-lg
                    .modal-header.bg-primary.text-white
                        h5.modal-title.fw-bold
                            i.bi.bi-person-fill.me-2
                            | Member Login
                        button.btn-close.btn-close-white(type="button" data-bs-dismiss="modal" aria-label="Close")
                    .modal-body.p-4
                        form#loginForm
                            .mb-3
                                label.form-label.text-muted.small(for="loginIdNumber") Turkish ID Number
                                .input-group
                                    span.input-group-text.bg-light.border-end-0
                                        i.bi.bi-card-heading.text-primary
                                    input.form-control.border-start-0.ps-0#loginIdNumber(type="text" name="idNumber" placeholder="11-digit ID number" maxlength="11" required)
                            .mb-4
                                label.form-label.text-muted.small(for="loginPassword") Password
                                .input-group
                                    span.input-group-text.bg-light.border-end-0
                                        i.bi.bi-key.text-primary
                                    input.form-control.border-start-0.ps-0#loginPassword(type="password" name="password" placeholder="******" required)
                            .d-grid
                                button.btn.btn-primary.btn-lg.fw-bold(type="submit")
                                    span.text-btn Log In
                                    span.spinner-border.spinner-border-sm.d-none(role="status" aria-hidden="true")

                        .text-center.mt-4.pt-3.border-top
                            p.small.text-muted.mb-1 Don’t have an account yet?
                            a.text-primary.fw-bold.text-decoration-none(href="#" data-bs-target="#registerModal" data-bs-toggle="modal")
                                | Sign up now

        // 2) REGISTER MODAL
        .modal.fade#registerModal(tabindex="-1" aria-hidden="true")
            .modal-dialog.modal-dialog-centered
                .modal-content.border-0.shadow-lg
                    .modal-header.bg-primary.text-white
                        h5.modal-title.fw-bold
                            i.bi.bi-person-plus-fill.me-2
                            | New Membership
                        button.btn-close.btn-close-white(type="button" data-bs-dismiss="modal" aria-label="Close")
                    .modal-body.p-4
                        form#registerForm
                            .row.g-3.mb-3
                                .col-6
                                    label.form-label.text-muted.small First name
                                    input.form-control(type="text" name="name" required)

                                .col-6
                                    label.form-label.text-muted.small Last name
                                    input.form-control(type="text" name="surname" required)

                            .mb-3
                                label.form-label.text-muted.small Turkish ID Number
                                input.form-control(type="text" name="idNumber" maxlength="11" required)

                            .mb-3
                                label.form-label.text-muted.small Phone
                                input.form-control(type="tel" name="phone" placeholder="5xx ..." maxlength="10" required)

                            .mb-3
                                label.form-label.text-muted.small Email
                                input.form-control(type="email" name="email" placeholder="example@email.com")

                            .mb-3
                                label.form-label.text-muted.small Gender
                                .d-flex.gap-3
                                    .form-check
                                        input.form-check-input(type="radio" name="gender" id="genderM" value="m" checked)
                                        label.form-check-label(for="genderM") Male
                                    .form-check
                                        input.form-check-input(type="radio" name="gender" id="genderF" value="f")
                                        label.form-check-label(for="genderF") Female

                            .mb-4
                                label.form-label.text-muted.small Set a password
                                input.form-control(type="password" name="password" required)

                            .d-grid
                                button.btn.btn-primary.btn-lg.fw-bold(type="submit")
                                    span.text-btn Complete signup
                                    span.spinner-border.spinner-border-sm.d-none(role="status" aria-hidden="true")

                        .text-center.mt-4.pt-3.border-top
                            p.small.text-muted.mb-1 Already a member?
                            a.text-primary.fw-bold.text-decoration-none(href="#" data-bs-target="#loginModal" data-bs-toggle="modal")
                                | Log in

        script(src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js")
        script(src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js")
        script(src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/js/all.min.js")
        script(src="https://cdn.jsdelivr.net/npm/flatpickr")
        script(src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/en.js")
        script(src="https://code.jquery.com/jquery-3.7.1.min.js")
        script(src="/js/script.js")
        script(src="/js/searchable-select.js")
        block js